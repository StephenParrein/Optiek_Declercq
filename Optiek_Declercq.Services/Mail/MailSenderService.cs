using MailKit.Net.Smtp;
using MailKit.Security;
using MimeKit;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace Optiek_Declercq.Services.Mail
{
    class MailSenderService
    {
        private readonly string host;
        private readonly int port;
        private readonly bool enableSSL;
        private readonly string userName;
        private readonly string password;

        public MailSenderService()
        {
            host = "gmail.com";
            port = 465;
            enableSSL = true;
            userName = "Info.Optiek.Declercq@gmail.com";
            password = "InfoMail.123";
        }

        public MailSenderService(string host, int port, bool enableSSL, string userName, string password)
        {
            this.host = host;
            this.port = port;
            this.enableSSL = enableSSL;
            this.userName = userName;
            this.password = password;
        }

        // Use our configuration to send the email by using SmtpClient
        public Task SendEmailAsync(string email, string subject, string htmlMessage)
        {
            var client = new SmtpClient
            {
                ServerCertificateValidationCallback = (s, c, h, e) => true
            };

            client.Connect(host, 465, SecureSocketOptions.SslOnConnect);

            client.Authenticate(userName, password);

            var message = new MimeMessage();

            message.From.Add(new MailboxAddress("Optiek Declercq", "optiek.declercq@skynet.be"));
            message.To.Add(new MailboxAddress(email));
            message.Subject = subject;

            var builder = new BodyBuilder
            {
                HtmlBody =
                @"<html>" +
                    @"<body style='background-color:whitesmoke; margin:auto; text-align:center;'>" +
                        @"<section style='font-size:small; list-style:none;'>" +
                            @"<table style='mso-special-format:none; list-style:none'>" +
                               @"<tr>" +
                                    @"<td style='text-align:left;'><a href='www.optiekdeclercq.net/'>" +
                                        @"<img src = 'data:image/png;base64,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' width=250 style='min-width:250px; max-width:250px;' />" +
                                    @"</a></td>" +
                                @"</tr>" +
                                @"<tr>" +
                                    @"<td style='text-align:left><a href = 'tel:+32 (51)31 34 41'> +32(51) 31 34 41</a></br>" +
                                    @"<a href = 'mailto:optiek.declercq@skynet.be'> optiek.declercq@skynet.be</a></td>" +
                                @"</tr>" +
                                @"<tr colspan=2 style='border-bottom:1pt solid black;'>" +

                                @"</tr>" +

                                @"<tr colspan=2 style='width:100%'>" +
                                    "<td>" + @htmlMessage + "</td>" +
                                @"</tr>" +
                            @"</table>" +

                            @"<div style='font-size=small;'>(Dit is een automatisch verzonden e-mail.)</div>" +
                        @"</section>" +
                    @"</body>" +
                @"</html>"
            };

            message.Body = builder.ToMessageBody();

            return client.SendAsync(message);
        }
    }
}
